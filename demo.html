<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å”è€é¸­æ¸¸ä¹å›­</title>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // ç®€å•çš„å›¾æ ‡ç»„ä»¶
    const MessageCircle = () => <span>ğŸ’¬</span>;
    const X = () => <span>âŒ</span>;
    const Code = () => <span>ğŸ’»</span>;
    const Brain = () => <span>ğŸ§ </span>;

    const DonaldDuckGame = () => {
      const [scene, setScene] = useState('main');
      const [showDialog, setShowDialog] = useState(false);
      const [userInput, setUserInput] = useState('');
      const [chatHistory, setChatHistory] = useState([]);
      const [donaldResponse, setDonaldResponse] = useState('');
      const [redPackets, setRedPackets] = useState([]);
      const [score, setScore] = useState(0);
      const [duckBAction, setDuckBAction] = useState('idle');
      const [duckBPosition, setDuckBPosition] = useState({ x: 200, y: 200 });
      const gameAreaRef = useRef(null);

      const littleDucks = [
        { id: 'a', name: 'å°çº¢', color: '#ef4444', trait: 'å–œæ¬¢æŠ¢çº¢åŒ…' },
        { id: 'b', name: 'å°è“', color: '#3b82f6', trait: 'æ´»æ³¼çˆ±ç©' },
        { id: 'c', name: 'å°ç»¿', color: '#22c55e', trait: 'èªæ˜å¥½å­¦' }
      ];

      useEffect(() => {
        if (scene === 'redpacket') {
          const interval = setInterval(() => {
            const newPacket = {
              id: Date.now(),
              x: Math.random() * 80 + 10,
              y: 0,
              size: Math.random() * 40 + 30,
              type: Math.random() > 0.5 ? 'circle' : 'square',
              value: Math.floor(Math.random() * 100) + 10
            };
            setRedPackets(prev => [...prev, newPacket]);
          }, 1500);
          return () => clearInterval(interval);
        }
      }, [scene]);

      useEffect(() => {
        if (scene === 'redpacket') {
          const interval = setInterval(() => {
            setRedPackets(prev => 
              prev.map(p => ({ ...p, y: p.y + 2 }))
                .filter(p => p.y < 100)
            );
          }, 50);
          return () => clearInterval(interval);
        }
      }, [scene]);

      const handleCommand = () => {
        const command = userInput.toLowerCase().trim();
        let response = '';
        
        if (command.includes('çº¢åŒ…')) {
          response = 'å¥½çš„ï¼æˆ‘ç°åœ¨å¼€å§‹å‘çº¢åŒ…å•¦ï¼å°çº¢å¿«æ¥æŠ¢ï¼ğŸ';
          setTimeout(() => {
            setScene('redpacket');
            setShowDialog(false);
          }, 1500);
        } else if (command.includes('ç»Ÿè®¡') && command.includes('ä»£ç ')) {
          response = 'è®©æˆ‘ç»Ÿè®¡ä¸€ä¸‹ä»£ç é‡...ğŸ“Š';
          setTimeout(() => {
            setScene('code');
            setShowDialog(false);
          }, 1500);
        } else if (command.includes('ai') || command.includes('é—®ç­”')) {
          response = 'æ­£åœ¨ä¸ºæ‚¨æ‰“å¼€AIé—®ç­”ç•Œé¢...ğŸ¤–';
          setTimeout(() => {
            setScene('ai');
            setShowDialog(false);
          }, 1500);
        } else if (command.includes('æ¸¸æˆ') && (command.includes('å°è“') || command.includes('b'))) {
          response = 'å¥½çš„ï¼è®©æˆ‘ä»¬å’Œå°è“ä¸€èµ·ç©å§ï¼ğŸ®';
          setTimeout(() => {
            setScene('play');
            setShowDialog(false);
          }, 1500);
        } else {
          response = 'å˜å˜å˜~æˆ‘è¿˜åœ¨å­¦ä¹ è¿™ä¸ªæŒ‡ä»¤å‘¢ï¼è¯•è¯•è¯´ï¼š"å‘çº¢åŒ…"ã€"ç»Ÿè®¡ä»£ç é‡"ã€"AIé—®ç­”"æˆ–"å’Œå°è“ç©æ¸¸æˆ"å§ï¼';
        }
        
        setDonaldResponse(response);
        setChatHistory(prev => [...prev, { user: userInput, donald: response }]);
        setUserInput('');
      };

      const catchRedPacket = (packet) => {
        setScore(prev => prev + packet.value);
        setRedPackets(prev => prev.filter(p => p.id !== packet.id));
      };

      const controlDuckB = (action) => {
        setDuckBAction(action);
        if (action === 'fly') {
          setDuckBPosition(prev => ({ ...prev, y: Math.max(50, prev.y - 50) }));
        }
      };

      useEffect(() => {
        if (scene === 'play') {
          const handleKeyPress = (e) => {
            const step = 15;
            setDuckBPosition(prev => {
              const newPos = { ...prev };
              if (e.key === 'ArrowLeft') newPos.x = Math.max(0, prev.x - step);
              if (e.key === 'ArrowRight') newPos.x = Math.min(700, prev.x + step);
              if (e.key === 'ArrowUp') newPos.y = Math.max(0, prev.y - step);
              if (e.key === 'ArrowDown') newPos.y = Math.min(500, prev.y + step);
              return newPos;
            });
          };
          window.addEventListener('keydown', handleKeyPress);
          return () => window.removeEventListener('keydown', handleKeyPress);
        }
      }, [scene]);

      return (
        <div className="w-full h-screen bg-gradient-to-b from-sky-200 to-sky-100 overflow-hidden">
          {scene === 'main' && (
            <div className="relative w-full h-full">
              <div className="absolute top-8 left-1/2 -translate-x-1/2 text-3xl font-bold text-blue-800">
                å”è€é¸­çš„æ¸¸ä¹å›­ ğŸ¦†
              </div>

              <div 
                className="absolute top-1/3 left-1/2 -translate-x-1/2 cursor-pointer group"
                onClick={() => setShowDialog(true)}
              >
                <div className="relative">
                  <div className="w-32 h-32 bg-white rounded-full border-4 border-blue-600 flex items-center justify-center text-6xl group-hover:scale-110 transition-transform">
                    ğŸ¦†
                  </div>
                  <div className="absolute -bottom-12 left-1/2 -translate-x-1/2 bg-blue-600 text-white px-4 py-2 rounded-full whitespace-nowrap font-bold">
                    å”è€é¸­ (ç‚¹å‡»å¯¹è¯)
                  </div>
                </div>
              </div>

              <div className="absolute bottom-32 left-1/2 -translate-x-1/2 flex gap-16">
                {littleDucks.map((duck) => (
                  <div key={duck.id} className="text-center">
                    <div 
                      className="w-24 h-24 rounded-full border-4 flex items-center justify-center text-5xl transition-transform hover:scale-110"
                      style={{ borderColor: duck.color, backgroundColor: 'white' }}
                    >
                      ğŸ¥
                    </div>
                    <div 
                      className="mt-2 px-3 py-1 rounded-full text-white font-bold text-sm"
                      style={{ backgroundColor: duck.color }}
                    >
                      {duck.name}
                    </div>
                    <div className="text-xs text-gray-600 mt-1">{duck.trait}</div>
                  </div>
                ))}
              </div>

              <div className="absolute bottom-8 left-1/2 -translate-x-1/2 text-center text-sm text-gray-600">
                <div className="flex gap-4 justify-center">
                  <span>ğŸ’° å‘çº¢åŒ…</span>
                  <span>ğŸ“Š ç»Ÿè®¡ä»£ç </span>
                  <span>ğŸ¤– AIé—®ç­”</span>
                  <span>ğŸ® ç©æ¸¸æˆ</span>
                </div>
              </div>
            </div>
          )}

          {showDialog && (
            <div className="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
              <div className="bg-white rounded-2xl p-6 w-96 max-h-96 shadow-2xl">
                <div className="flex justify-between items-center mb-4">
                  <h3 className="text-xl font-bold text-blue-800 flex items-center gap-2">
                    <MessageCircle />
                    ä¸å”è€é¸­å¯¹è¯
                  </h3>
                  <button onClick={() => setShowDialog(false)} className="text-gray-500 hover:text-gray-700">
                    <X />
                  </button>
                </div>

                <div className="mb-4 max-h-40 overflow-y-auto space-y-2">
                  {donaldResponse && (
                    <div className="bg-blue-50 p-3 rounded-lg">
                      <div className="text-sm font-semibold text-blue-800">å”è€é¸­:</div>
                      <div className="text-sm">{donaldResponse}</div>
                    </div>
                  )}
                </div>

                <div className="flex gap-2">
                  <input
                    type="text"
                    value={userInput}
                    onChange={(e) => setUserInput(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && handleCommand()}
                    placeholder="è¾“å…¥æŒ‡ä»¤,å¦‚:å‘çº¢åŒ…..."
                    className="flex-1 px-4 py-2 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500"
                  />
                  <button
                    onClick={handleCommand}
                    className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold"
                  >
                    å‘é€
                  </button>
                </div>
              </div>
            </div>
          )}

          {scene === 'redpacket' && (
            <div className="relative w-full h-full">
              <button
                onClick={() => { setScene('main'); setScore(0); setRedPackets([]); }}
                className="absolute top-4 left-4 px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-100 z-10"
              >
                â† è¿”å›
              </button>
              
              <div className="absolute top-4 right-4 bg-white px-6 py-3 rounded-lg shadow-lg z-10">
                <div className="text-2xl font-bold text-red-600">ğŸ’° {score} å…ƒ</div>
              </div>

              <div className="absolute top-20 left-1/2 -translate-x-1/2 text-2xl font-bold text-blue-800">
                ğŸ¦† å”è€é¸­å‘çº¢åŒ…ä¸­...
              </div>

              <div className="absolute bottom-20 left-1/2 -translate-x-1/2 text-6xl">
                ğŸ¥
              </div>
              <div className="absolute bottom-8 left-1/2 -translate-x-1/2 text-red-600 font-bold">
                å°çº¢æŠ¢çº¢åŒ…ä¸­ (ç‚¹å‡»çº¢åŒ…)
              </div>

              {redPackets.map(packet => (
                <div
                  key={packet.id}
                  onClick={() => catchRedPacket(packet)}
                  className="absolute cursor-pointer hover:scale-110 transition-transform"
                  style={{
                    left: `${packet.x}%`,
                    top: `${packet.y}%`,
                    width: packet.size,
                    height: packet.size,
                  }}
                >
                  {packet.type === 'circle' ? (
                    <div className="w-full h-full bg-red-500 rounded-full flex items-center justify-center text-white font-bold shadow-lg">
                      {packet.value}
                    </div>
                  ) : (
                    <div className="w-full h-full bg-red-600 flex items-center justify-center text-white font-bold shadow-lg">
                      {packet.value}
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}

          {scene === 'code' && (
            <div className="relative w-full h-full p-8">
              <button
                onClick={() => setScene('main')}
                className="absolute top-4 left-4 px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-100"
              >
                â† è¿”å›
              </button>

              <div className="max-w-4xl mx-auto mt-16">
                <div className="flex items-center gap-3 mb-6">
                  <Code />
                  <h2 className="text-3xl font-bold text-blue-800">ä»£ç ç»Ÿè®¡ç»“æœ</h2>
                </div>

                <div className="bg-white rounded-xl shadow-lg p-6">
                  <div className="font-mono text-sm space-y-2">
                    <div className="border-b pb-2 mb-4 font-bold text-gray-700">
                      Language          Files    Lines    Code    Comments    Blanks
                    </div>
                    <div className="text-blue-600">JavaScript         12     2456    2103       234       119</div>
                    <div className="text-green-600">CSS                 8      892     756        89        47</div>
                    <div className="text-yellow-600">HTML                5      432     389        21        22</div>
                    <div className="text-purple-600">JSON                3      156     156         0         0</div>
                    <div className="border-t pt-2 mt-4 font-bold">
                      Total              28     3936    3404       344       188
                    </div>
                  </div>
                </div>

                <div className="mt-8 text-center">
                  <div className="text-6xl mb-4">ğŸ¦†</div>
                  <div className="text-xl text-blue-800 font-bold">
                    å”è€é¸­: ç»Ÿè®¡å®Œæˆï¼ä»£ç é‡è¿˜ä¸é”™å“¦ï¼
                  </div>
                </div>
              </div>
            </div>
          )}

          {scene === 'ai' && (
            <div className="relative w-full h-full p-8">
              <button
                onClick={() => setScene('main')}
                className="absolute top-4 left-4 px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-100"
              >
                â† è¿”å›
              </button>

              <div className="max-w-3xl mx-auto mt-16">
                <div className="flex items-center gap-3 mb-6">
                  <Brain />
                  <h2 className="text-3xl font-bold text-blue-800">AIæ™ºèƒ½é—®ç­”</h2>
                </div>

                <div className="bg-white rounded-xl shadow-lg p-6 mb-4 min-h-80">
                  <div className="text-center py-12">
                    <div className="text-6xl mb-4">ğŸ¤–</div>
                    <div className="text-gray-500 mb-4">AIæ¨¡å‹æ¥å…¥åŒºåŸŸ</div>
                    <div className="text-sm text-gray-400">
                      (æ­¤å¤„å¯æ¥å…¥API: OpenAI, Claude, æ–‡å¿ƒä¸€è¨€ç­‰)
                    </div>
                  </div>
                </div>

                <div className="flex gap-2">
                  <input
                    type="text"
                    placeholder="å‘AIæé—®..."
                    className="flex-1 px-4 py-3 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                  />
                  <button className="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-bold">
                    æé—®
                  </button>
                </div>
              </div>
            </div>
          )}

          {scene === 'play' && (
            <div className="relative w-full h-full" ref={gameAreaRef}>
              <button
                onClick={() => { setScene('main'); setDuckBAction('idle'); setDuckBPosition({ x: 200, y: 200 }); }}
                className="absolute top-4 left-4 px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-100 z-10"
              >
                â† è¿”å›
              </button>

              <div className="absolute top-4 left-1/2 -translate-x-1/2 text-2xl font-bold text-blue-800">
                ğŸ® å’Œå°è“ä¸€èµ·ç©
              </div>

              <div className="absolute top-20 left-4 bg-white rounded-xl shadow-lg p-4 space-y-2">
                <button
                  onClick={() => controlDuckB('fly')}
                  className="w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                >
                  âœˆï¸ é£ç¿”
                </button>
                <button
                  onClick={() => controlDuckB('quack')}
                  className="w-full px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600"
                >
                  ğŸ”Š å«å”¤
                </button>
                <button
                  onClick={() => controlDuckB('sleep')}
                  className="w-full px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600"
                >
                  ğŸ˜´ ç¡è§‰
                </button>
                <button
                  onClick={() => controlDuckB('dance')}
                  className="w-full px-4 py-2 bg-pink-500 text-white rounded hover:bg-pink-600"
                >
                  ğŸ’ƒ è·³èˆ
                </button>
                <div className="text-xs text-gray-500 mt-4 pt-4 border-t">
                  ç”¨æ–¹å‘é”®ç§»åŠ¨å°è“
                </div>
              </div>

              <div
                className="absolute transition-all duration-300"
                style={{
                  left: duckBPosition.x,
                  top: duckBPosition.y,
                  transform: duckBAction === 'fly' ? 'rotate(-15deg)' : 'rotate(0deg)'
                }}
              >
                <div className="text-7xl">
                  {duckBAction === 'sleep' && 'ğŸ˜´'}
                  {duckBAction === 'quack' && 'ğŸ¦†'}
                  {duckBAction === 'fly' && 'ğŸ¦'}
                  {duckBAction === 'dance' && 'ğŸ’ƒ'}
                  {duckBAction === 'idle' && 'ğŸ¥'}
                </div>
              </div>

              <div className="absolute bottom-8 left-1/2 -translate-x-1/2 bg-white px-6 py-3 rounded-full shadow-lg">
                <span className="font-bold text-blue-600">å°è“çŠ¶æ€: </span>
                <span className="text-gray-700">
                  {duckBAction === 'fly' && 'é£ç¿”ä¸­'}
                  {duckBAction === 'quack' && 'å˜å˜å˜~'}
                  {duckBAction === 'sleep' && 'ç¡è§‰ä¸­...'}
                  {duckBAction === 'dance' && 'è·³èˆä¸­'}
                  {duckBAction === 'idle' && 'å¾…å‘½ä¸­'}
                </span>
              </div>
            </div>
          )}
        </div>
      );
    };

    ReactDOM.render(<DonaldDuckGame />, document.getElementById('root'));
  </script>
</body>
</html>